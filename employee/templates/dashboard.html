{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<div class="container mt-5">

  <h1 class="mb-4 text-center text-warning">üìä Employee Dashboard</h1>

  <!-- Stats Cards -->
  <div class="row text-center mb-4">
    <div class="col-md-3">
      <div class="card bg-primary text-white">
        <div class="card-body">
          <h5>Total Employees</h5>
          <h2>{{ total_employees }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-success text-white">
        <div class="card-body">
          <h5>Active Employees</h5>
          <h2>{{ active_employees }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-danger text-white">
        <div class="card-body">
          <h5>Expired Contracts</h5>
          <h2>{{ expired_contracts }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-warning text-dark">
        <div class="card-body">
          <h5>New Joins ({{ today|date:"F" }})</h5>
          <h2>{{ recent_joins }}</h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Contract Expiry Alert -->
  {% if expiring_contracts %}
    <div class="alert alert-warning">
      <strong>‚ö†Ô∏è Contracts expiring in the next 3 days:</strong>
      <ul>
        {% for emp in expiring_contracts %}
          <li>{{ emp.full_name }} - ends on {{ emp.end_date }}</li>
        {% endfor %}
      </ul> 
    </div>
  {% endif %}

  <!-- Recent Employees Table -->
  <h3 class="mt-5">üßë‚Äçüíº Recently Added Employees</h3>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Name</th>
        <th>Position</th>
        <th>Join Date</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for emp in recent_employees %}
        <tr>
          <td>{{ emp.full_name }}</td>
          <td>{{ emp.position }}</td>
          <td>{{ emp.date_of_joining }}</td>
          <td>
            {% if emp.is_active %}
              <span class="badge bg-success">Active</span>
            {% else %}
              <span class="badge bg-secondary">Inactive</span>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Quick Links -->
  <div class="mt-4">
    <a href="{% url 'add_employee' %}" class="btn btn-outline-primary">‚ûï Add Employee</a>
    <a href="{% url 'generate_offer_letter' %}" class="btn btn-outline-success">üìÑ Generate Offer Letter</a>
    <a href="{% url 'all_employees' %}" class="btn btn-outline-dark">üìã View All Employees</a>
  </div>
</div>

{% endblock %}
